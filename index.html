<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Webroot</title>
<link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link type="text/css" rel="stylesheet" href="localsite/css/base.css" id="localsite/css/base.css" />
<link type="text/css" rel="stylesheet" href="team/css/common.css" />

<script>
  var rootPath = "https://harimayooram.github.io/webroot-earth/localsite/";
  window.param = { root: rootPath };
  window.localsite_root = rootPath;
  console.log("Configured Root:", rootPath);
</script>

<script type="text/javascript" src="localsite/js/localsite.js?showheader=true&showsearch=true"></script>
<script type="text/javascript" src="team/js/common.js"></script>
<script type="text/javascript" src="team/js/setup.js"></script>

<script>
autoCreateOSDetectionPanel('#commonSetupDiv');

loadMarkdown("README.md", "readmeDiv", "_parent", 1, function() {
    let currentPath = window.location.href;
    let myRepo = "PartnerTools";

    const githubPagesMatch = currentPath.match(/\/\/([^.]+)\.github\.io\/([^/]+)/);
    if (githubPagesMatch && githubPagesMatch[2]) {
        myRepo = githubPagesMatch[2]; 
    } else if (currentPath.includes("localhost") || currentPath.includes("model.earth")) {
        myRepo = "modelearth";
    }

    let linkString = "<a href='https://github.com/HariMayooram/webroot-earth/' target='github_fork'>github.com/HariMayooram/webroot-earth</a>";

    setTimeout(() => {
        const textInPage = document.getElementById('textInPage');
        if (textInPage) {
            textInPage.innerHTML = textInPage.innerHTML.replace(/the webroot repo/g, linkString);
            updateGitAccountFields();
        }
    }, 100);

    setTimeout(() => {
        setupWebrootSetup('webrootSetup');
        setupGitAccountFields('textInPage');
        setupTradeFlowRepos('tradeFlowRepos');
        setupGeminiResources();
        setupBackendInfo('backendInfo');
        loadMarkdown("deploy.md", "deployDiv", "_parent", 1);
        setTimeout(() => { updateForkReposCommands(); }, 100);
    }, 200);

    const readmeDiv = document.getElementById('readmeDiv');
    if (readmeDiv) {
        let content = readmeDiv.innerHTML;
        const currentPort = window.location.port;
        if (currentPort && currentPort !== '8887') {
             content = content.replace(/localhost:8887/g, `localhost:${currentPort}`);
        }
        readmeDiv.innerHTML = content;
    }
});
</script>
</head>

<body>
<div class="content contentpadding">
    <div class="card" id="textInPage">
      <div id="webrootSetup"></div>
    </div>
    <div id="commonSetupDiv"></div>
    <div id="readmeDiv" class="card"></div>
    <div class="card" id="tradeFlowRepos"></div>
    <div class="card" id="backendInfo"></div>
    <div class="card" id="deployDiv"></div>

    <div id="nl-search-wrapper" style="display:none; margin-top:12px;">
      <label for="nl-search-input" style="display:block;margin-bottom:6px;">Natural language search</label>
      <div style="display:flex;gap:8px;">
        <input id="nl-search-input" type="text" style="flex:1;padding:8px;" />
        <button id="nl-search-btn" style="padding:8px 12px;">Search</button>
      </div>
      <pre id="nl-search-results" style="margin-top:10px;white-space:pre-wrap;"></pre>
    </div>

<script>
  const isLocal = ['localhost','127.0.0.1','::1'].includes(location.hostname);
  const wrapper = document.getElementById('nl-search-wrapper');
  if (isLocal && wrapper) {
    wrapper.style.display = '';
    (function loadSharedInsights(){
      function loadScript(src, cb){
        var s = document.createElement('script'); s.src = src;
        s.onload = cb; 
        document.head.appendChild(s);
      }

      var queue = [];
      // 4. QUEUE: Keep relative (No slashes)
      if (typeof window.apiCall !== 'function') queue.push('team/js/common.js');
      if (typeof window.setupGeminiIntegration !== 'function' && typeof window.queryGeminiAI !== 'function') queue.push('team/js/projects.js');

      function runQueue(){
        if (queue.length === 0) return initNL();
        var src = queue.shift();
        loadScript(src, runQueue);
      }

      function initNL(){
        try { window.ENABLE_CLAUDE_HAIKU_4_5 = true; } catch(e){}
        var btn = document.getElementById('nl-search-btn');
        var input = document.getElementById('nl-search-input');
        if (btn && input){
          btn.addEventListener('click', function(){ alert("Search feature active"); });
        }
      }
      runQueue();
    })();
  }
</script>
</div>
</body>
</html>
